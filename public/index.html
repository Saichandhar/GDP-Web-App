<!DOCTYPE html>
<html lang="en">

<head>
  <title>Login | By Code Info</title>
  <link rel="stylesheet" href="style_login.css" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
  <!-- <script src="login.js"></script>  -->
</head>


<body>
  <h1>Smart Mobility</h1>
  <div class="login-box">
    <h3>Login</h3>
    <form>
      <label>Email</label>
      <input type="email" placeholder="" id="username" />
      <label>Password</label>
      <input type="password" placeholder="" id="password" />
      <!--  <input type="button" value="Submit" onclick="validate()" /> -->

      <button type="button" id="submitData" name="submitData" class="registerbtn">Submit</button>
    </form>
  </div>
  <p class="para-2">
    Not have an account? &nbsp <a href="signup.html">Sign Up Here</a>
  </p>
  <p class="para-2">
    <a href="">Forgot password ?</a>
  </p>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
    crossorigin="anonymous"></script>
</body>


</html>


<script src="https://www.gstatic.com/firebasejs/5.0.1/firebase.js"></script>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-auth.js";
  import { getDatabase, set, ref,update } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-database.js";
  // import firebase from 'firebase/compat/app';
  // import {firebase} from "firebase/app";
  
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDghAAvMSGvON4Lmd-jop0VyjOiAC5t8lM",
      authDomain: "smart-mobility-ios.firebaseapp.com",
      databaseURL: "https://smart-mobility-ios-default-rtdb.firebaseio.com",
      projectId: "smart-mobility-ios",
      storageBucket: "smart-mobility-ios.appspot.com",
      messagingSenderId: "727144855934",
      appId: "1:727144855934:web:2ca21a0d262114a85ddb2f",
      measurementId: "G-5SNWQ6NS22"
  };

  // Initialize Firebase
  console.log("login")
  firebase.initializeApp(firebaseConfig);
  const dbRef = firebase.database().ref("admin-signup-users/");
// const usersRef = dbRef.child('users2');

  // const app = initializeApp(firebaseConfig);

  // const auth = getAuth();

  // const database = getDatabase(app);

  submitData.addEventListener('click', (e) => {


    var email = document.getElementById('username').value;
    var password = document.getElementById("password").value;
  console.log("email",email,password)
  // const ref =database.ref('users2/');

  dbRef.on("child_added", function(snapshot,prevChildKey) {
    // var em=email.split(/[^A-Za-z]/)[0];
    // console.log("em",em);
    var data = snapshot.val();
  //  console.log("data=",data.email,data,password);
   if(data.email==email&&data.password==password){
    console.log("success");
    window.location.assign("Dashboard.html");
   }
   else{
    console.log("no")
   }
}, function (error) {
   console.log("Error: " + error.code);
});
    
        // createUserWithEmailAndPassword(auth, email, password)
        //   .then((userCredential) => {
        //     // Signed in 
        //     const user = userCredential.user;
        //     // ...
    
        //     set(ref(database, 'users/' + user.uid), {
    
        //       email: email,
        //       password: password,
    
        //     })
    
        //   .then(() => {
        //       // Data saved successfully!
    
        //       window.location.assign("index.html");
        //       alert("Login succesfully");
        //     })
        //       .catch((error) => {
        //         // The write failed...
        //         alert("Error");
        //       });
    
    
        //   })
        //   .catch((error) => {
        //     const errorCode = error.code;
        //     const errorMessage = error.message;
        //     // ..
        //     alert("Login failed");
    
        //   });
    
  //  const auth=getAuth();
  //   signInWithEmailAndPassword(auth,email, password)
  //  .then((userCredential)=> {
  //      // Success 
  //      const user=userCredential.user;
       
  //           alert("Login succesfully");
  //  })
  // .catch(function(error) {
  //      // Error Handling
  //      alert("Error");
  // });
    // signInWithEmailAndPassword(auth, email, password)
    //   .then((userCredential) => {
    //     // Signed in 
    //     const user = userCredential.user;
    //     // ...

    //     var lgDate = new Date();
    //     // update(ref(database, 'users2/' + user.uid), {

    //     //   last_login: lgDate,

    //     // })

    //     //   .then(() => {
    //         // Data saved successfully!

    //         window.location.assign("Dashboard.html");
    //         alert("Login succesfully");
    //       // })
    //       // .catch((error) => {
    //       //   // The write failed...
    //       //   alert("Error");
    //       // });

    //   })
    //   .catch((error) => {
    //     const errorCode = error.code;
    //     const errorMessage = error.message;
    //     alert(errorMessage);
    //   });

  });
</script>