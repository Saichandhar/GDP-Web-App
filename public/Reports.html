<!DOCTYPE html>
<html lang="en">

<head>
  <title>Login | By Code Info</title>
  <link rel="stylesheet" href="AddBike.css" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

  <!-- <script src="login.js"></script>  -->
</head>


<body>
   
  <h1>Smart Mobility</h1>
  <div class="login-box">
    <h3>Reports
    </h3>
   
        <form action="" class="AddBike"  id="AddBike">
      <label>Date</label>
      <input type="text" placeholder="Enter the Date" id="date" />
      <label>Source</label>
      <input type="text" placeholder="Enter Source" id="source" />
      <label>Destination</label>
      <input type="text" placeholder="Enter Destination" id="destination" />

      <button type="button" id="submitData" name="submitData" class="registerbtn">Generate Reports</button>
      <div>
        <p class="h6" id="reports"></p>
      </div>
    </form>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
    import { getDatabase, ref, set, onValue, update, remove } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-database.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
    
    // Your web app's Firebase configuration
    const firebaseConfig = {
    apiKey: "AIzaSyDghAAvMSGvON4Lmd-jop0VyjOiAC5t8lM",
    authDomain: "smart-mobility-ios.firebaseapp.com",
    databaseURL: "https://smart-mobility-ios-default-rtdb.firebaseio.com",
    projectId: "smart-mobility-ios",
    storageBucket: "smart-mobility-ios.appspot.com",
    messagingSenderId: "727144855934",
    appId: "1:727144855934:web:2ca21a0d262114a85ddb2f",
    measurementId: "G-5SNWQ6NS22"
  };
  
      // Initialize Firebase
       const app = initializeApp(firebaseConfig);
       const database = getDatabase(app);
  
       submitData.addEventListener('click',(e) => {
      
      var date = document.getElementById('date').value;
      var source = document.getElementById('source').value;
      var destination = document.getElementById('destination').value;
      console.log(date,source,destination)

      const databaseRef = ref(database, "rental/");

            onValue(databaseRef, (snapshot) => {
                var users = [];

                snapshot.forEach(childSnapshot => {
                    // console.log(childSnapshot.val().rentDateTime,childSnapshot.val().destination,childSnapshot.val().source)
                    if(childSnapshot.val().destination==destination && childSnapshot.val().source==source && childSnapshot.val().rentDateTime==date){
                        users.push(childSnapshot.val());
                    }
                    

                });
                console.log(users.length)
                document.getElementById("reports").innerHTML = "Number of Riders from "+source+" to "+destination+ " : "+users.length;

            });
      
      });

      
    //   function GetalldataRealtime() {
    //         const databaseRef = ref(database, "rental/");

    //         onValue(databaseRef, (snapshot) => {
    //             var users = [];

    //             snapshot.forEach(childSnapshot => {
    //                 users.push(childSnapshot.val());

    //             });
    //             console.log(users.length)
    //             BikeLength=users.length;
    //         });
    //     }
    //     window.onload = GetalldataRealtime;

  
     
  </script>
  <script src ="./Addbike.js"></script>

</body>
</html>